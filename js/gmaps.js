"use strict";(function(a,b){if(typeof exports==='object'){module.exports=b()}else if(typeof define==='function'&&define.amd){define(['jquery','googlemaps!'],b)}else{a.GMaps=b()}}(this,function(){var w=function(a,b){var c;if(a===b){return a}for(c in b){if(b[c]!==undefined){a[c]=b[c]}}return a};var x=function(a,b){var c;if(a===b){return a}for(c in b){if(a[c]!=undefined){a[c]=b[c]}}return a};var y=function(c,d){var e=Array.prototype.slice.call(arguments,2),array_return=[],array_length=c.length,i;if(Array.prototype.map&&c.map===Array.prototype.map){array_return=Array.prototype.map.call(c,function(a){var b=e.slice(0);b.splice(0,0,a);return d.apply(this,b)})}else{for(i=0;i<array_length;i++){callback_params=e;callback_params.splice(0,0,c[i]);array_return.push(d.apply(this,callback_params))}}return array_return};var z=function(a){var b=[],i;for(i=0;i<a.length;i++){b=b.concat(a[i])}return b};var A=function(a,b){var c=a[0],second_coord=a[1];if(b){c=a[1];second_coord=a[0]}return new google.maps.LatLng(c,second_coord)};var B=function(a,b){var i;for(i=0;i<a.length;i++){if(!(a[i]instanceof google.maps.LatLng)){if(a[i].length>0&&typeof(a[i][0])==="object"){a[i]=B(a[i],b)}else{a[i]=A(a[i],b)}}}return a};var C=function(a,b){var c,_class=a.replace('.','');if('jQuery'in this&&b){c=$("."+_class,b)[0]}else{c=document.getElementsByClassName(_class)[0]}return c};var D=function(a,b){var c,a=a.replace('#','');if('jQuery'in window&&b){c=$('#'+a,b)[0]}else{c=document.getElementById(a)};return c};var E=function(a){var b=0,curtop=0;if(a.getBoundingClientRect){var c=a.getBoundingClientRect();var d=-(window.scrollX?window.scrollX:window.pageXOffset);var e=-(window.scrollY?window.scrollY:window.pageYOffset);return[(c.left-d),(c.top-e)]}if(a.offsetParent){do{b+=a.offsetLeft;curtop+=a.offsetTop}while(a=a.offsetParent)}return[b,curtop]};var F=(function(t){"use strict";var u=document;var v=function(l){if(!(typeof window.google==='object'&&window.google.maps)){if(typeof window.console==='object'&&window.console.error){console.error('Google Maps API is required. Please register the following JavaScript library https://maps.googleapis.com/maps/api/js.')}return function(){}}if(!this)return new v(l);l.zoom=l.zoom||15;l.mapType=l.mapType||'roadmap';var m=function(a,b){return a===undefined?b:a};var n=this,i,events_that_hide_context_menu=['bounds_changed','center_changed','click','dblclick','drag','dragend','dragstart','idle','maptypeid_changed','projection_changed','resize','tilesloaded','zoom_changed'],events_that_doesnt_hide_context_menu=['mousemove','mouseout','mouseover'],options_to_be_deleted=['el','lat','lng','mapType','width','height','markerClusterer','enableNewStyle'],identifier=l.el||l.div,markerClustererFunction=l.markerClusterer,mapType=google.maps.MapTypeId[l.mapType.toUpperCase()],map_center=new google.maps.LatLng(l.lat,l.lng),zoomControl=m(l.zoomControl,true),zoomControlOpt=l.zoomControlOpt||{style:'DEFAULT',position:'TOP_LEFT'},zoomControlStyle=zoomControlOpt.style||'DEFAULT',zoomControlPosition=zoomControlOpt.position||'TOP_LEFT',panControl=m(l.panControl,true),mapTypeControl=m(l.mapTypeControl,true),scaleControl=m(l.scaleControl,true),streetViewControl=m(l.streetViewControl,true),overviewMapControl=m(overviewMapControl,true),map_options={},map_base_options={zoom:this.zoom,center:map_center,mapTypeId:mapType},map_controls_options={panControl:panControl,zoomControl:zoomControl,zoomControlOptions:{style:google.maps.ZoomControlStyle[zoomControlStyle],position:google.maps.ControlPosition[zoomControlPosition]},mapTypeControl:mapTypeControl,scaleControl:scaleControl,streetViewControl:streetViewControl,overviewMapControl:overviewMapControl};if(typeof(l.el)==='string'||typeof(l.div)==='string'){if(identifier.indexOf("#")>-1){this.el=D(identifier,l.context)}else{this.el=C.apply(this,[identifier,l.context])}}else{this.el=identifier}if(typeof(this.el)==='undefined'||this.el===null){throw'No element defined.';}window.context_menu=window.context_menu||{};window.context_menu[n.el.id]={};this.controls=[];this.overlays=[];this.layers=[];this.singleLayers={};this.markers=[];this.polylines=[];this.routes=[];this.polygons=[];this.infoWindow=null;this.overlay_el=null;this.zoom=l.zoom;this.registered_events={};this.el.style.width=l.width||this.el.scrollWidth||this.el.offsetWidth;this.el.style.height=l.height||this.el.scrollHeight||this.el.offsetHeight;google.maps.visualRefresh=l.enableNewStyle;for(i=0;i<options_to_be_deleted.length;i++){delete l[options_to_be_deleted[i]]}if(l.disableDefaultUI!=true){map_base_options=w(map_base_options,map_controls_options)}map_options=w(map_base_options,l);for(i=0;i<events_that_hide_context_menu.length;i++){delete map_options[events_that_hide_context_menu[i]]}for(i=0;i<events_that_doesnt_hide_context_menu.length;i++){delete map_options[events_that_doesnt_hide_context_menu[i]]}this.map=new google.maps.Map(this.el,map_options);if(markerClustererFunction){this.markerClusterer=markerClustererFunction.apply(this,[this.map])}var o=function(b,e){var c='',l=window.context_menu[n.el.id][b];for(var i in l){if(l.hasOwnProperty(i)){var d=l[i];c+='<li><a id="'+b+'_'+i+'" href="#">'+d.title+'</a></li>'}}if(!D('gmaps_context_menu'))return;var f=D('gmaps_context_menu');f.innerHTML=c;var g=f.getElementsByTagName('a'),context_menu_items_count=g.length,i;for(i=0;i<context_menu_items_count;i++){var h=g[i];var j=function(a){a.preventDefault();l[this.id.replace(b+'_','')].action.apply(n,[e]);n.hideContextMenu()};google.maps.event.clearListeners(h,'click');google.maps.event.addDomListenerOnce(h,'click',j,false)}var k=E.apply(this,[n.el]),left=k[0]+e.pixel.x-15,top=k[1]+e.pixel.y-15;f.style.left=left+"px";f.style.top=top+"px"};this.buildContextMenu=function(b,e){if(b==='marker'){e.pixel={};var c=new google.maps.OverlayView();c.setMap(n.map);c.draw=function(){var a=c.getProjection(),position=e.marker.getPosition();e.pixel=a.fromLatLngToContainerPixel(position);o(b,e)}}else{o(b,e)}var d=D('gmaps_context_menu');setTimeout(function(){d.style.display='block'},0)};this.setContextMenu=function(b){window.context_menu[n.el.id][b.control]={};var i,ul=u.createElement('ul');for(i in b.options){if(b.options.hasOwnProperty(i)){var c=b.options[i];window.context_menu[n.el.id][b.control][c.name]={title:c.title,action:c.action}}}ul.id='gmaps_context_menu';ul.style.display='none';ul.style.position='absolute';ul.style.minWidth='100px';ul.style.background='white';ul.style.listStyle='none';ul.style.padding='8px';ul.style.boxShadow='2px 2px 6px #ccc';if(!D('gmaps_context_menu')){u.body.appendChild(ul)}var d=D('gmaps_context_menu');google.maps.event.addDomListener(d,'mouseout',function(a){if(!a.relatedTarget||!this.contains(a.relatedTarget)){window.setTimeout(function(){d.style.display='none'},400)}},false)};this.hideContextMenu=function(){var a=D('gmaps_context_menu');if(a){a.style.display='none'}};var p=function(a,b){google.maps.event.addListener(a,b,function(e){if(e==undefined){e=this}l[b].apply(this,[e]);n.hideContextMenu()})};google.maps.event.addListener(this.map,'zoom_changed',this.hideContextMenu);for(var q=0;q<events_that_hide_context_menu.length;q++){var r=events_that_hide_context_menu[q];if(r in l){p(this.map,r)}}for(var q=0;q<events_that_doesnt_hide_context_menu.length;q++){var r=events_that_doesnt_hide_context_menu[q];if(r in l){p(this.map,r)}}google.maps.event.addListener(this.map,'rightclick',function(e){if(l.rightclick){l.rightclick.apply(this,[e])}if(window.context_menu[n.el.id]['map']!=undefined){n.buildContextMenu('map',e)}});this.refresh=function(){google.maps.event.trigger(this.map,'resize')};this.fitZoom=function(){var a=[],markers_length=this.markers.length,i;for(i=0;i<markers_length;i++){if(typeof(this.markers[i].visible)==='boolean'&&this.markers[i].visible){a.push(this.markers[i].getPosition())}}this.fitLatLngBounds(a)};this.fitLatLngBounds=function(a){var b=a.length,bounds=new google.maps.LatLngBounds(),i;for(i=0;i<b;i++){bounds.extend(a[i])}this.map.fitBounds(bounds)};this.setCenter=function(a,b,c){this.map.panTo(new google.maps.LatLng(a,b));if(c){c()}};this.getElement=function(){return this.el};this.zoomIn=function(a){a=a||1;this.zoom=this.map.getZoom()+a;this.map.setZoom(this.zoom)};this.zoomOut=function(a){a=a||1;this.zoom=this.map.getZoom()-a;this.map.setZoom(this.zoom)};var s=[],method;for(method in this.map){if(typeof(this.map[method])=='function'&&!this[method]){s.push(method)}}for(i=0;i<s.length;i++){(function(a,b,c){a[c]=function(){return b[c].apply(b,arguments)}})(this,this.map,s[i])}};return v})(this);F.prototype.createControl=function(c){var d=document.createElement('div');d.style.cursor='pointer';if(c.disableDefaultStyles!==true){d.style.fontFamily='Roboto, Arial, sans-serif';d.style.fontSize='11px';d.style.boxShadow='rgba(0, 0, 0, 0.298039) 0px 1px 4px -1px'}for(var e in c.style){d.style[e]=c.style[e]}if(c.id){d.id=c.id}if(c.title){d.title=c.title}if(c.classes){d.className=c.classes}if(c.content){if(typeof c.content==='string'){d.innerHTML=c.content}else if(c.content instanceof HTMLElement){d.appendChild(c.content)}}if(c.position){d.position=google.maps.ControlPosition[c.position.toUpperCase()]}for(var f in c.events){(function(a,b){google.maps.event.addDomListener(a,b,function(){c.events[b].apply(this,[this])})})(d,f)}d.index=1;return d};F.prototype.addControl=function(a){var b=this.createControl(a);this.controls.push(b);this.map.controls[b.position].push(b);return b};F.prototype.removeControl=function(a){var b=null,i;for(i=0;i<this.controls.length;i++){if(this.controls[i]==a){b=this.controls[i].position;this.controls.splice(i,1)}}if(b){for(i=0;i<this.map.controls.length;i++){var c=this.map.controls[a.position];if(c.getAt(i)==a){c.removeAt(i);break}}}return a};F.prototype.createMarker=function(g){if(g.lat==undefined&&g.lng==undefined&&g.position==undefined){throw'No latitude or longitude defined.';}var h=this,details=g.details,fences=g.fences,outside=g.outside,base_options={position:new google.maps.LatLng(g.lat,g.lng),map:null},marker_options=w(base_options,g);delete marker_options.lat;delete marker_options.lng;delete marker_options.fences;delete marker_options.outside;var i=new google.maps.Marker(marker_options);i.fences=fences;if(g.infoWindow){i.infoWindow=new google.maps.InfoWindow(g.infoWindow);var j=['closeclick','content_changed','domready','position_changed','zindex_changed'];for(var k=0;k<j.length;k++){(function(a,b){if(g.infoWindow[b]){google.maps.event.addListener(a,b,function(e){g.infoWindow[b].apply(this,[e])})}})(i.infoWindow,j[k])}}var l=['animation_changed','clickable_changed','cursor_changed','draggable_changed','flat_changed','icon_changed','position_changed','shadow_changed','shape_changed','title_changed','visible_changed','zindex_changed'];var n=['dblclick','drag','dragend','dragstart','mousedown','mouseout','mouseover','mouseup'];for(var k=0;k<l.length;k++){(function(a,b){if(g[b]){google.maps.event.addListener(a,b,function(){g[b].apply(this,[this])})}})(i,l[k])}for(var k=0;k<n.length;k++){(function(b,c,d){if(g[d]){google.maps.event.addListener(c,d,function(a){if(!a.pixel){a.pixel=b.getProjection().fromLatLngToPoint(a.latLng)}g[d].apply(this,[a])})}})(this.map,i,n[k])}google.maps.event.addListener(i,'click',function(){this.details=details;if(g.click){g.click.apply(this,[this])}if(i.infoWindow){h.hideInfoWindows();i.infoWindow.open(h.map,i)}});google.maps.event.addListener(i,'rightclick',function(e){e.marker=this;if(g.rightclick){g.rightclick.apply(this,[e])}if(window.context_menu[h.el.id]['marker']!=undefined){h.buildContextMenu('marker',e)}});if(i.fences){google.maps.event.addListener(i,'dragend',function(){h.checkMarkerGeofence(i,function(m,f){outside(m,f)})})}return i};F.prototype.addMarker=function(a){var b;if(a.hasOwnProperty('gm_accessors_')){b=a}else{if((a.hasOwnProperty('lat')&&a.hasOwnProperty('lng'))||a.position){b=this.createMarker(a)}else{throw'No latitude or longitude defined.';}}b.setMap(this.map);if(this.markerClusterer){this.markerClusterer.addMarker(b)}this.markers.push(b);F.fire('marker_added',b,this);return b};F.prototype.addMarkers=function(a){for(var i=0,marker;marker=a[i];i++){this.addMarker(marker)}return this.markers};F.prototype.hideInfoWindows=function(){for(var i=0,marker;marker=this.markers[i];i++){if(marker.infoWindow){marker.infoWindow.close()}}};F.prototype.removeMarker=function(a){for(var i=0;i<this.markers.length;i++){if(this.markers[i]===a){this.markers[i].setMap(null);this.markers.splice(i,1);if(this.markerClusterer){this.markerClusterer.removeMarker(a)}F.fire('marker_removed',a,this);break}}return a};F.prototype.removeMarkers=function(a){var b=[];if(typeof a=='undefined'){for(var i=0;i<this.markers.length;i++){var c=this.markers[i];c.setMap(null);F.fire('marker_removed',c,this)}if(this.markerClusterer&&this.markerClusterer.clearMarkers){this.markerClusterer.clearMarkers()}this.markers=b}else{for(var i=0;i<a.length;i++){var d=this.markers.indexOf(a[i]);if(d>-1){var c=this.markers[d];c.setMap(null);if(this.markerClusterer){this.markerClusterer.removeMarker(c)}F.fire('marker_removed',c,this)}}for(var i=0;i<this.markers.length;i++){var c=this.markers[i];if(c.getMap()!=null){b.push(c)}}this.markers=b}};F.prototype.drawOverlay=function(g){var h=new google.maps.OverlayView(),auto_show=true;h.setMap(this.map);if(g.auto_show!=null){auto_show=g.auto_show}h.onAdd=function(){var c=document.createElement('div');c.style.borderStyle="none";c.style.borderWidth="0px";c.style.position="absolute";c.style.zIndex=100;c.innerHTML=g.content;h.el=c;if(!g.layer){g.layer='overlayLayer'}var d=this.getPanes(),overlayLayer=d[g.layer],stop_overlay_events=['contextmenu','DOMMouseScroll','dblclick','mousedown'];overlayLayer.appendChild(c);for(var f=0;f<stop_overlay_events.length;f++){(function(a,b){google.maps.event.addDomListener(a,b,function(e){if(navigator.userAgent.toLowerCase().indexOf('msie')!=-1&&document.all){e.cancelBubble=true;e.returnValue=false}else{e.stopPropagation()}})})(c,stop_overlay_events[f])}if(g.click){d.overlayMouseTarget.appendChild(h.el);google.maps.event.addDomListener(h.el,'click',function(){g.click.apply(h,[h])})}google.maps.event.trigger(this,'ready')};h.draw=function(){var a=this.getProjection(),pixel=a.fromLatLngToDivPixel(new google.maps.LatLng(g.lat,g.lng));g.horizontalOffset=g.horizontalOffset||0;g.verticalOffset=g.verticalOffset||0;var b=h.el,content=b.children[0],content_height=content.clientHeight,content_width=content.clientWidth;switch(g.verticalAlign){case'top':b.style.top=(pixel.y-content_height+g.verticalOffset)+'px';break;default:case'middle':b.style.top=(pixel.y-(content_height/2)+g.verticalOffset)+'px';break;case'bottom':b.style.top=(pixel.y+g.verticalOffset)+'px';break}switch(g.horizontalAlign){case'left':b.style.left=(pixel.x-content_width+g.horizontalOffset)+'px';break;default:case'center':b.style.left=(pixel.x-(content_width/2)+g.horizontalOffset)+'px';break;case'right':b.style.left=(pixel.x+g.horizontalOffset)+'px';break}b.style.display=auto_show?'block':'none';if(!auto_show){g.show.apply(this,[b])}};h.onRemove=function(){var a=h.el;if(g.remove){g.remove.apply(this,[a])}else{h.el.parentNode.removeChild(h.el);h.el=null}};this.overlays.push(h);return h};F.prototype.removeOverlay=function(a){for(var i=0;i<this.overlays.length;i++){if(this.overlays[i]===a){this.overlays[i].setMap(null);this.overlays.splice(i,1);break}}};F.prototype.removeOverlays=function(){for(var i=0,item;item=this.overlays[i];i++){item.setMap(null)}this.overlays=[]};F.prototype.drawPolyline=function(c){var d=[],points=c.path;if(points.length){if(points[0][0]===undefined){d=points}else{for(var i=0,latlng;latlng=points[i];i++){d.push(new google.maps.LatLng(latlng[0],latlng[1]))}}}var f={map:this.map,path:d,strokeColor:c.strokeColor,strokeOpacity:c.strokeOpacity,strokeWeight:c.strokeWeight,geodesic:c.geodesic,clickable:true,editable:false,visible:true};if(c.hasOwnProperty("clickable")){f.clickable=c.clickable}if(c.hasOwnProperty("editable")){f.editable=c.editable}if(c.hasOwnProperty("icons")){f.icons=c.icons}if(c.hasOwnProperty("zIndex")){f.zIndex=c.zIndex}var g=new google.maps.Polyline(f);var h=['click','dblclick','mousedown','mousemove','mouseout','mouseover','mouseup','rightclick'];for(var j=0;j<h.length;j++){(function(a,b){if(c[b]){google.maps.event.addListener(a,b,function(e){c[b].apply(this,[e])})}})(g,h[j])}this.polylines.push(g);F.fire('polyline_added',g,this);return g};F.prototype.removePolyline=function(a){for(var i=0;i<this.polylines.length;i++){if(this.polylines[i]===a){this.polylines[i].setMap(null);this.polylines.splice(i,1);F.fire('polyline_removed',a,this);break}}};F.prototype.removePolylines=function(){for(var i=0,item;item=this.polylines[i];i++){item.setMap(null)}this.polylines=[]};F.prototype.drawCircle=function(c){c=w({map:this.map,center:new google.maps.LatLng(c.lat,c.lng)},c);delete c.lat;delete c.lng;var d=new google.maps.Circle(c),polygon_events=['click','dblclick','mousedown','mousemove','mouseout','mouseover','mouseup','rightclick'];for(var f=0;f<polygon_events.length;f++){(function(a,b){if(c[b]){google.maps.event.addListener(a,b,function(e){c[b].apply(this,[e])})}})(d,polygon_events[f])}this.polygons.push(d);return d};F.prototype.drawRectangle=function(c){c=w({map:this.map},c);var d=new google.maps.LatLngBounds(new google.maps.LatLng(c.bounds[0][0],c.bounds[0][1]),new google.maps.LatLng(c.bounds[1][0],c.bounds[1][1]));c.bounds=d;var f=new google.maps.Rectangle(c),polygon_events=['click','dblclick','mousedown','mousemove','mouseout','mouseover','mouseup','rightclick'];for(var g=0;g<polygon_events.length;g++){(function(a,b){if(c[b]){google.maps.event.addListener(a,b,function(e){c[b].apply(this,[e])})}})(f,polygon_events[g])}this.polygons.push(f);return f};F.prototype.drawPolygon=function(c){var d=false;if(c.hasOwnProperty("useGeoJSON")){d=c.useGeoJSON}delete c.useGeoJSON;c=w({map:this.map},c);if(d==false){c.paths=[c.paths.slice(0)]}if(c.paths.length>0){if(c.paths[0].length>0){c.paths=z(y(c.paths,B,d))}}var f=new google.maps.Polygon(c),polygon_events=['click','dblclick','mousedown','mousemove','mouseout','mouseover','mouseup','rightclick'];for(var g=0;g<polygon_events.length;g++){(function(a,b){if(c[b]){google.maps.event.addListener(a,b,function(e){c[b].apply(this,[e])})}})(f,polygon_events[g])}this.polygons.push(f);F.fire('polygon_added',f,this);return f};F.prototype.removePolygon=function(a){for(var i=0;i<this.polygons.length;i++){if(this.polygons[i]===a){this.polygons[i].setMap(null);this.polygons.splice(i,1);F.fire('polygon_removed',a,this);break}}};F.prototype.removePolygons=function(){for(var i=0,item;item=this.polygons[i];i++){item.setMap(null)}this.polygons=[]};F.prototype.getFromFusionTables=function(c){var d=c.events;delete c.events;var f=c,layer=new google.maps.FusionTablesLayer(f);for(var g in d){(function(a,b){google.maps.event.addListener(a,b,function(e){d[b].apply(this,[e])})})(layer,g)}this.layers.push(layer);return layer};F.prototype.loadFromFusionTables=function(a){var b=this.getFromFusionTables(a);b.setMap(this.map);return b};F.prototype.getFromKML=function(c){var d=c.url,events=c.events;delete c.url;delete c.events;var f=c,layer=new google.maps.KmlLayer(d,f);for(var g in events){(function(a,b){google.maps.event.addListener(a,b,function(e){events[b].apply(this,[e])})})(layer,g)}this.layers.push(layer);return layer};F.prototype.loadFromKML=function(a){var b=this.getFromKML(a);b.setMap(this.map);return b};F.prototype.addLayer=function(b,c){c=c||{};var d;switch(b){case'weather':this.singleLayers.weather=d=new google.maps.weather.WeatherLayer();break;case'clouds':this.singleLayers.clouds=d=new google.maps.weather.CloudLayer();break;case'traffic':this.singleLayers.traffic=d=new google.maps.TrafficLayer();break;case'transit':this.singleLayers.transit=d=new google.maps.TransitLayer();break;case'bicycling':this.singleLayers.bicycling=d=new google.maps.BicyclingLayer();break;case'panoramio':this.singleLayers.panoramio=d=new google.maps.panoramio.PanoramioLayer();d.setTag(c.filter);delete c.filter;if(c.click){google.maps.event.addListener(d,'click',function(a){c.click(a);delete c.click})}break;case'places':this.singleLayers.places=d=new google.maps.places.PlacesService(this.map);if(c.search||c.nearbySearch||c.radarSearch){var e={bounds:c.bounds||null,keyword:c.keyword||null,location:c.location||null,name:c.name||null,radius:c.radius||null,rankBy:c.rankBy||null,types:c.types||null};if(c.radarSearch){d.radarSearch(e,c.radarSearch)}if(c.search){d.search(e,c.search)}if(c.nearbySearch){d.nearbySearch(e,c.nearbySearch)}}if(c.textSearch){var f={bounds:c.bounds||null,location:c.location||null,query:c.query||null,radius:c.radius||null};d.textSearch(f,c.textSearch)}break}if(d!==undefined){if(typeof d.setOptions=='function'){d.setOptions(c)}if(typeof d.setMap=='function'){d.setMap(this.map)}return d}};F.prototype.removeLayer=function(a){if(typeof(a)=="string"&&this.singleLayers[a]!==undefined){this.singleLayers[a].setMap(null);delete this.singleLayers[a]}else{for(var i=0;i<this.layers.length;i++){if(this.layers[i]===a){this.layers[i].setMap(null);this.layers.splice(i,1);break}}}};var G,unitSystem;F.prototype.getRoutes=function(c){switch(c.travelMode){case'bicycling':G=google.maps.TravelMode.BICYCLING;break;case'transit':G=google.maps.TravelMode.TRANSIT;break;case'driving':G=google.maps.TravelMode.DRIVING;break;default:G=google.maps.TravelMode.WALKING;break}if(c.unitSystem==='imperial'){unitSystem=google.maps.UnitSystem.IMPERIAL}else{unitSystem=google.maps.UnitSystem.METRIC}var d={avoidHighways:false,avoidTolls:false,optimizeWaypoints:false,waypoints:[]},request_options=w(d,c);request_options.origin=/string/.test(typeof c.origin)?c.origin:new google.maps.LatLng(c.origin[0],c.origin[1]);request_options.destination=/string/.test(typeof c.destination)?c.destination:new google.maps.LatLng(c.destination[0],c.destination[1]);request_options.travelMode=G;request_options.unitSystem=unitSystem;delete request_options.callback;delete request_options.error;var e=this,routes=[],service=new google.maps.DirectionsService();service.route(request_options,function(a,b){if(b===google.maps.DirectionsStatus.OK){for(var r in a.routes){if(a.routes.hasOwnProperty(r)){routes.push(a.routes[r])}}if(c.callback){c.callback(routes,a,b)}}else{if(c.error){c.error(a,b)}}})};F.prototype.removeRoutes=function(){this.routes.length=0};F.prototype.getElevations=function(c){c=w({locations:[],path:false,samples:256},c);if(c.locations.length>0){if(c.locations[0].length>0){c.locations=z(y([c.locations],B,false))}}var d=c.callback;delete c.callback;var e=new google.maps.ElevationService();if(!c.path){delete c.path;delete c.samples;e.getElevationForLocations(c,function(a,b){if(d&&typeof(d)==="function"){d(a,b)}})}else{var f={path:c.locations,samples:c.samples};e.getElevationAlongPath(f,function(a,b){if(d&&typeof(d)==="function"){d(a,b)}})}};F.prototype.cleanRoute=F.prototype.removePolylines;F.prototype.renderRoute=function(d,e){var f=this,panel=((typeof e.panel==='string')?document.getElementById(e.panel.replace('#','')):e.panel),display;e.panel=panel;e=w({map:this.map},e);display=new google.maps.DirectionsRenderer(e);this.getRoutes({origin:d.origin,destination:d.destination,travelMode:d.travelMode,waypoints:d.waypoints,unitSystem:d.unitSystem,error:d.error,avoidHighways:d.avoidHighways,avoidTolls:d.avoidTolls,optimizeWaypoints:d.optimizeWaypoints,callback:function(a,b,c){if(c===google.maps.DirectionsStatus.OK){display.setDirections(b)}}})};F.prototype.drawRoute=function(c){var d=this;this.getRoutes({origin:c.origin,destination:c.destination,travelMode:c.travelMode,waypoints:c.waypoints,unitSystem:c.unitSystem,error:c.error,avoidHighways:c.avoidHighways,avoidTolls:c.avoidTolls,optimizeWaypoints:c.optimizeWaypoints,callback:function(a){if(a.length>0){var b={path:a[a.length-1].overview_path,strokeColor:c.strokeColor,strokeOpacity:c.strokeOpacity,strokeWeight:c.strokeWeight};if(c.hasOwnProperty("icons")){b.icons=c.icons}d.drawPolyline(b);if(c.callback){c.callback(a[a.length-1])}}}})};F.prototype.travelRoute=function(c){if(c.origin&&c.destination){this.getRoutes({origin:c.origin,destination:c.destination,travelMode:c.travelMode,waypoints:c.waypoints,unitSystem:c.unitSystem,error:c.error,callback:function(e){if(e.length>0&&c.start){c.start(e[e.length-1])}if(e.length>0&&c.step){var a=e[e.length-1];if(a.legs.length>0){var b=a.legs[0].steps;for(var i=0,step;step=b[i];i++){step.step_number=i;c.step(step,(a.legs[0].steps.length-1))}}}if(e.length>0&&c.end){c.end(e[e.length-1])}}})}else if(c.route){if(c.route.legs.length>0){var d=c.route.legs[0].steps;for(var i=0,step;step=d[i];i++){step.step_number=i;c.step(step)}}}};F.prototype.drawSteppedRoute=function(d){var f=this;if(d.origin&&d.destination){this.getRoutes({origin:d.origin,destination:d.destination,travelMode:d.travelMode,waypoints:d.waypoints,error:d.error,callback:function(e){if(e.length>0&&d.start){d.start(e[e.length-1])}if(e.length>0&&d.step){var a=e[e.length-1];if(a.legs.length>0){var b=a.legs[0].steps;for(var i=0,step;step=b[i];i++){step.step_number=i;var c={path:step.path,strokeColor:d.strokeColor,strokeOpacity:d.strokeOpacity,strokeWeight:d.strokeWeight};if(d.hasOwnProperty("icons")){c.icons=d.icons}f.drawPolyline(c);d.step(step,(a.legs[0].steps.length-1))}}}if(e.length>0&&d.end){d.end(e[e.length-1])}}})}else if(d.route){if(d.route.legs.length>0){var g=d.route.legs[0].steps;for(var i=0,step;step=g[i];i++){step.step_number=i;var h={path:step.path,strokeColor:d.strokeColor,strokeOpacity:d.strokeOpacity,strokeWeight:d.strokeWeight};if(d.hasOwnProperty("icons")){h.icons=d.icons}f.drawPolyline(h);d.step(step)}}}};F.Route=function(a){this.origin=a.origin;this.destination=a.destination;this.waypoints=a.waypoints;this.map=a.map;this.route=a.route;this.step_count=0;this.steps=this.route.legs[0].steps;this.steps_length=this.steps.length;var b={path:new google.maps.MVCArray(),strokeColor:a.strokeColor,strokeOpacity:a.strokeOpacity,strokeWeight:a.strokeWeight};if(a.hasOwnProperty("icons")){b.icons=a.icons}this.polyline=this.map.drawPolyline(b).getPath()};F.Route.prototype.getRoute=function(a){var b=this;this.map.getRoutes({origin:this.origin,destination:this.destination,travelMode:a.travelMode,waypoints:this.waypoints||[],error:a.error,callback:function(){b.route=e[0];if(a.callback){a.callback.call(b)}}})};F.Route.prototype.back=function(){if(this.step_count>0){this.step_count--;var a=this.route.legs[0].steps[this.step_count].path;for(var p in a){if(a.hasOwnProperty(p)){this.polyline.pop()}}}};F.Route.prototype.forward=function(){if(this.step_count<this.steps_length){var a=this.route.legs[0].steps[this.step_count].path;for(var p in a){if(a.hasOwnProperty(p)){this.polyline.push(a[p])}}this.step_count++}};F.prototype.checkGeofence=function(a,b,c){return c.containsLatLng(new google.maps.LatLng(a,b))};F.prototype.checkMarkerGeofence=function(a,b){if(a.fences){for(var i=0,fence;fence=a.fences[i];i++){var c=a.getPosition();if(!this.checkGeofence(c.lat(),c.lng(),fence)){b(a,fence)}}}};F.prototype.toImage=function(a){var a=a||{},static_map_options={};static_map_options['size']=a['size']||[this.el.clientWidth,this.el.clientHeight];static_map_options['lat']=this.getCenter().lat();static_map_options['lng']=this.getCenter().lng();if(this.markers.length>0){static_map_options['markers']=[];for(var i=0;i<this.markers.length;i++){static_map_options['markers'].push({lat:this.markers[i].getPosition().lat(),lng:this.markers[i].getPosition().lng()})}}if(this.polylines.length>0){var b=this.polylines[0];static_map_options['polyline']={};static_map_options['polyline']['path']=google.maps.geometry.encoding.encodePath(b.getPath());static_map_options['polyline']['strokeColor']=b.strokeColor static_map_options['polyline']['strokeOpacity']=b.strokeOpacity static_map_options['polyline']['strokeWeight']=b.strokeWeight}return F.staticMapURL(static_map_options)};F.staticMapURL=function(c){var d=[],data,static_root=(location.protocol==='file:'?'http:':location.protocol)+'//maps.googleapis.com/maps/api/staticmap';if(c.url){static_root=c.url;delete c.url}static_root+='?';var e=c.markers;delete c.markers;if(!e&&c.marker){e=[c.marker];delete c.marker}var f=c.styles;delete c.styles;var g=c.polyline;delete c.polyline;if(c.center){d.push('center='+c.center);delete c.center}else if(c.address){d.push('center='+c.address);delete c.address}else if(c.lat){d.push(['center=',c.lat,',',c.lng].join(''));delete c.lat;delete c.lng}else if(c.visible){var h=encodeURI(c.visible.join('|'));d.push('visible='+h)}var k=c.size;if(k){if(k.join){k=k.join('x')}delete c.size}else{k='630x300'}d.push('size='+k);if(!c.zoom&&c.zoom!==false){c.zoom=15}var l=c.hasOwnProperty('sensor')?!!c.sensor:true;delete c.sensor;d.push('sensor='+l);for(var m in c){if(c.hasOwnProperty(m)){d.push(m+'='+c[m])}}if(e){var n,loc;for(var i=0;data=e[i];i++){n=[];if(data.size&&data.size!=='normal'){n.push('size:'+data.size);delete data.size}else if(data.icon){n.push('icon:'+encodeURI(data.icon));delete data.icon}if(data.color){n.push('color:'+data.color.replace('#','0x'));delete data.color}if(data.label){n.push('label:'+data.label[0].toUpperCase());delete data.label}loc=(data.address?data.address:data.lat+','+data.lng);delete data.address;delete data.lat;delete data.lng;for(var m in data){if(data.hasOwnProperty(m)){n.push(m+':'+data[m])}}if(n.length||i===0){n.push(loc);n=n.join('|');d.push('markers='+encodeURI(n))}else{n=d.pop()+encodeURI('|'+loc);d.push(n)}}}if(f){for(var i=0;i<f.length;i++){var o=[];if(f[i].featureType){o.push('feature:'+f[i].featureType.toLowerCase())}if(f[i].elementType){o.push('element:'+f[i].elementType.toLowerCase())}for(var j=0;j<f[i].stylers.length;j++){for(var p in f[i].stylers[j]){var q=f[i].stylers[j][p];if(p=='hue'||p=='color'){q='0x'+q.substring(1)}o.push(p+':'+q)}}var r=o.join('|');if(r!=''){d.push('style='+r)}}}function parseColor(a,b){if(a[0]==='#'){a=a.replace('#','0x');if(b){b=parseFloat(b);b=Math.min(1,Math.max(b,0));if(b===0){return'0x00000000'}b=(b*255).toString(16);if(b.length===1){b+=b}a=a.slice(0,8)+b}}return a}if(g){data=g;g=[];if(data.strokeWeight){g.push('weight:'+parseInt(data.strokeWeight,10))}if(data.strokeColor){var s=parseColor(data.strokeColor,data.strokeOpacity);g.push('color:'+s)}if(data.fillColor){var t=parseColor(data.fillColor,data.fillOpacity);g.push('fillcolor:'+t)}var u=data.path;if(u.join){for(var j=0,pos;pos=u[j];j++){g.push(pos.join(','))}}else{g.push('enc:'+u)}g=g.join('|');d.push('path='+encodeURI(g))}var v=window.devicePixelRatio||1;d.push('scale='+v);d=d.join('&');return static_root+d};F.prototype.addMapType=function(a,b){if(b.hasOwnProperty("getTileUrl")&&typeof(b["getTileUrl"])=="function"){b.tileSize=b.tileSize||new google.maps.Size(256,256);var c=new google.maps.ImageMapType(b);this.map.mapTypes.set(a,c)}else{throw"'getTileUrl' function required.";}};F.prototype.addOverlayMapType=function(a){if(a.hasOwnProperty("getTile")&&typeof(a["getTile"])=="function"){var b=a.index;delete a.index;this.map.overlayMapTypes.insertAt(b,a)}else{throw"'getTile' function required.";}};F.prototype.removeOverlayMapType=function(a){this.map.overlayMapTypes.removeAt(a)};F.prototype.addStyle=function(a){var b=new google.maps.StyledMapType(a.styles,{name:a.styledMapName});this.map.mapTypes.set(a.mapTypeId,b)};F.prototype.setStyle=function(a){this.map.setMapTypeId(a)};F.prototype.createPanorama=function(a){if(!a.hasOwnProperty('lat')||!a.hasOwnProperty('lng')){a.lat=this.getCenter().lat();a.lng=this.getCenter().lng()}this.panorama=F.createPanorama(a);this.map.setStreetView(this.panorama);return this.panorama};F.createPanorama=function(c){var d=D(c.el,c.context);c.position=new google.maps.LatLng(c.lat,c.lng);delete c.el;delete c.context;delete c.lat;delete c.lng;var e=['closeclick','links_changed','pano_changed','position_changed','pov_changed','resize','visible_changed'],streetview_options=w({visible:true},c);for(var i=0;i<e.length;i++){delete streetview_options[e[i]]}var f=new google.maps.StreetViewPanorama(d,streetview_options);for(var i=0;i<e.length;i++){(function(a,b){if(c[b]){google.maps.event.addListener(a,b,function(){c[b].apply(this)})}})(f,e[i])}return f};F.prototype.on=function(a,b){return F.on(a,this,b)};F.prototype.off=function(a){F.off(a,this)};F.prototype.once=function(a,b){return F.once(a,this,b)};F.custom_events=['marker_added','marker_removed','polyline_added','polyline_removed','polygon_added','polygon_removed','geolocated','geolocation_failed'];F.on=function(a,b,c){if(F.custom_events.indexOf(a)==-1){if(b instanceof F)b=b.map;return google.maps.event.addListener(b,a,c)}else{var d={handler:c,eventName:a};b.registered_events[a]=b.registered_events[a]||[];b.registered_events[a].push(d);return d}};F.off=function(a,b){if(F.custom_events.indexOf(a)==-1){if(b instanceof F)b=b.map;google.maps.event.clearListeners(b,a)}else{b.registered_events[a]=[]}};F.once=function(a,b,c){if(F.custom_events.indexOf(a)==-1){if(b instanceof F)b=b.map;return google.maps.event.addListenerOnce(b,a,c)}};F.fire=function(d,e,f){if(F.custom_events.indexOf(d)==-1){google.maps.event.trigger(e,d,Array.prototype.slice.apply(arguments).slice(2))}else{if(d in f.registered_events){var g=f.registered_events[d];for(var i=0;i<g.length;i++){(function(a,b,c){a.apply(b,[c])})(g[i]['handler'],f,e)}}}};F.geolocate=function(b){var c=b.always||b.complete;if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(a){b.success(a);if(c){c()}},function(a){b.error(a);if(c){c()}},b.options)}else{b.not_supported();if(c){c()}}};F.geocode=function(c){this.geocoder=new google.maps.Geocoder();var d=c.callback;if(c.hasOwnProperty('lat')&&c.hasOwnProperty('lng')){c.latLng=new google.maps.LatLng(c.lat,c.lng)}delete c.lat;delete c.lng;delete c.callback;this.geocoder.geocode(c,function(a,b){d(a,b)})};if(typeof window.google==='object'&&window.google.maps){if(!google.maps.Polygon.prototype.getBounds){google.maps.Polygon.prototype.getBounds=function(a){var b=new google.maps.LatLngBounds();var c=this.getPaths();var d;for(var p=0;p<c.getLength();p++){d=c.getAt(p);for(var i=0;i<d.getLength();i++){b.extend(d.getAt(i))}}return b}}if(!google.maps.Polygon.prototype.containsLatLng){google.maps.Polygon.prototype.containsLatLng=function(a){var b=this.getBounds();if(b!==null&&!b.contains(a)){return false}var c=false;var d=this.getPaths().getLength();for(var p=0;p<d;p++){var e=this.getPaths().getAt(p);var f=e.getLength();var j=f-1;for(var i=0;i<f;i++){var g=e.getAt(i);var h=e.getAt(j);if(g.lng()<a.lng()&&h.lng()>=a.lng()||h.lng()<a.lng()&&g.lng()>=a.lng()){if(g.lat()+(a.lng()-g.lng())/(h.lng()-g.lng())*(h.lat()-g.lat())<a.lat()){c=!c}}j=i}}return c}}if(!google.maps.Circle.prototype.containsLatLng){google.maps.Circle.prototype.containsLatLng=function(a){if(google.maps.geometry){return google.maps.geometry.spherical.computeDistanceBetween(this.getCenter(),a)<=this.getRadius()}else{return true}}}google.maps.Rectangle.prototype.containsLatLng=function(a){return this.getBounds().contains(a)};google.maps.LatLngBounds.prototype.containsLatLng=function(a){return this.contains(a)};google.maps.Marker.prototype.setFences=function(a){this.fences=a};google.maps.Marker.prototype.addFence=function(a){this.fences.push(a)};google.maps.Marker.prototype.getId=function(){return this['__gm_id']}}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(a){"use strict";if(this==null){throw new TypeError();}var t=Object(this);var b=t.length>>>0;if(b===0){return-1}var n=0;if(arguments.length>1){n=Number(arguments[1]);if(n!=n){n=0}else if(n!=0&&n!=Infinity&&n!=-Infinity){n=(n>0||-1)*Math.floor(Math.abs(n))}}if(n>=b){return-1}var k=n>=0?n:Math.max(b-Math.abs(n),0);for(;k<b;k++){if(k in t&&t[k]===a){return k}}return-1}}return F}));